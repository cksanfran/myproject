This is a bug fix by tom
